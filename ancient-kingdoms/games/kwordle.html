<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KWORDLE | K-Story</title>

<style>
body{
    margin:0;
    font-family:"Poppins",sans-serif;
    background:linear-gradient(180deg,#f7eee5,#f3e2d8,#f9e8d3);
    text-align:center;
    color:#3a302a;
}

/* HERO */
.hero{
    background:linear-gradient(135deg,#d46a34,#c8553e,#a1425a,#6c4a8a,#3e5e9e);
    color:#fff9f0;
    padding:50px 20px;
    border-bottom:8px solid #8c3d2d;
}
.hero h1{font-size:46px;margin:0}

/* BOARD */
#board{
    margin:35px auto;
    display:grid;
    gap:6px;
    justify-content:center;
}

.tile{
    width:60px;
    height:60px;
    border:2px solid #9e7e64;
    background:#d2b89a;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:26px;
    font-weight:bold;
    border-radius:8px;
    user-select:none;
}

.tile.active{
    outline:3px solid #d46a34;
}

/* COLORS */
.correct{background:#6aaa64;color:white;}
.present{background:#c9b458;color:white;}
.absent{background:#787c7e;color:white;}

/* FLIP */
.flip{animation:flip .4s ease;}
@keyframes flip{
    0%{transform:rotateX(0)}
    50%{transform:rotateX(90deg)}
    100%{transform:rotateX(0)}
}

/* TOAST */
#toast{
    position:fixed;
    bottom:30px;
    left:50%;
    transform:translateX(-50%);
    background:#3a302a;
    color:white;
    padding:12px 18px;
    border-radius:10px;
    opacity:0;
    transition:.3s;
    pointer-events:none;
}
</style>
</head>

<body>

<div class="hero">
<h1>KWORDLE</h1>
<p>Guess the Korean King or Founder</p>
</div>

<div id="board"></div>
<div id="toast"></div>

<script>

/* =====================
   KING WORD LIST
===================== */
const words=[
"DANGUN","JUMONG","YURI","ONJO","HYEOKGEOSE",
"SURO","DAEMUSIN","GOI","GEUNCHOGO",
"GWANGGAETO","JANGSU","MU"
];

let answer = words[Math.floor(Math.random()*words.length)];
let length = answer.length;

let tries = 6;
let row = 0;
let col = 0;

/* Track guesses */
let guesses = Array.from({length:tries},()=>Array(length).fill(""));

/* =====================
   BUILD BOARD
===================== */
const board=document.getElementById("board");
board.style.gridTemplateColumns=`repeat(${length},60px)`;

for(let r=0;r<tries;r++){
    for(let c=0;c<length;c++){
        let tile=document.createElement("div");
        tile.className="tile";
        tile.dataset.row=r;
        tile.dataset.col=c;
        tile.onclick=()=>setCursor(r,c);
        board.appendChild(tile);
    }
}

highlight();

/* =====================
   CURSOR
===================== */
function setCursor(r,c){
    if(r!==row) return;
    col=c;
    highlight();
}

function highlight(){
    document.querySelectorAll(".tile")
    .forEach(t=>t.classList.remove("active"));

    let tile=getTile(row,col);
    if(tile) tile.classList.add("active");
}

function getTile(r,c){
    return document.querySelector(
        `.tile[data-row='${r}'][data-col='${c}']`
    );
}

/* =====================
   TOAST MESSAGE
===================== */
function toast(msg){
    const t=document.getElementById("toast");
    t.textContent=msg;
    t.style.opacity=1;
    setTimeout(()=>t.style.opacity=0,1800);
}

/* =====================
   KEYBOARD INPUT
===================== */
document.addEventListener("keydown",e=>{

    if(row>=tries) return;

    /* LETTER */
    if(/^[a-z]$/i.test(e.key)){
        if(col<length){
            guesses[row][col]=e.key.toUpperCase();
            getTile(row,col).textContent=e.key.toUpperCase();
            col++;
            highlight();
        }
    }

    /* BACKSPACE */
    if(e.key==="Backspace"){
        if(col>0){
            col--;
            guesses[row][col]="";
            getTile(row,col).textContent="";
            highlight();
        }
    }

    /* ENTER */
    if(e.key==="Enter"){
        submitGuess();
    }

});

/* =====================
   SUBMIT GUESS
===================== */
function submitGuess(){

    /* FIXED VALIDATION */
    if(guesses[row].includes("")){
        toast("Not enough letters");
        return;
    }

    let guess = guesses[row].join("");

    if(!words.includes(guess)){
        toast("Not in king list");
        return;
    }

    let answerArr=answer.split("");
    let guessArr=guess.split("");

    /* GREEN PASS */
    for(let i=0;i<length;i++){
        if(guessArr[i]===answerArr[i]){
            answerArr[i]=null;
            guessArr[i]=null;
            paint(i,"correct");
        }
    }

    /* YELLOW / GRAY */
    for(let i=0;i<length;i++){
        if(guessArr[i]==null) continue;

        if(answerArr.includes(guessArr[i])){
            answerArr[answerArr.indexOf(guessArr[i])]=null;
            paint(i,"present");
        }else{
            paint(i,"absent");
        }
    }

    /* WIN */
    if(guess===answer){
        toast("ðŸŽ‰ Correct!");
        row=tries;
        return;
    }

    row++;
    col=0;
    highlight();

    if(row===tries){
        toast("Answer: "+answer);
    }
}

/* =====================
   PAINT TILES
===================== */
function paint(i,color){
    let tile=getTile(row,i);

    setTimeout(()=>{
        tile.classList.add("flip");
        setTimeout(()=>{
            tile.classList.add(color);
        },150);
    },i*200);
}

</script>

</body>
</html>
